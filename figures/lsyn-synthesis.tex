\begin{figure}
  \begin{center}
    \begin{gather*}
      \fbox{$Γ ⊢ τ ⇝ E$} \qquad
        \inferrule[eguess-var]
          {x{:}τ ∈ Γ}
          {Γ ⊢ τ ⇝ x} \qquad
        \inferrule[eguess-app]
          {Γ ⊢ E ⇝ τ_1 → τ_2 \\ Γ ⊢ τ_1 ▷ · ⇝ I}
          {Γ ⊢ τ_2 ⇝ E\;I} \\
      \fbox{$Γ ⊢ τ ▷ Χ ⇝ I$} \qquad
        \inferrule[irefine-arr]
          {X = σ_1 ↦ pf_1, …, σ_n ↦ pf_n \\\\
            Χ' = \mfun{apply}(x, σ_1, pf_1) \concat … \concat \mfun{apply}(x, σ_n, pf_n) \\\\
            x{:}τ_1, Γ ⊢ τ_2 ▷ Χ' ⇝ I}
          {Γ ⊢ τ_1 → τ_2 ▷ Χ ⇝ λx{:}τ_1.\,I} \\
        \inferrule[irefine-base]
          {Χ = σ_1 ↦ c_k, …, σ_n ↦ c_k}
          {Γ ⊢ T ▷ Χ ⇝ c_k} \qquad
        \inferrule[irefine-guess]
          {Γ ⊢ τ ⇝ E \\ E ⊢ Χ}
          {Γ ⊢ τ ▷ Χ ⇝ E} \\
      \fbox{$I ⊢ Χ$} \qquad
        \inferrule[satisfies]
          {∀σ ↦ χ ∈ Χ.\;σ(I) ⟶^* v ∧ v ≃ χ}
          {I ⊢ Χ} \\
      \fbox{$v ≃ χ$} \qquad
        \inferrule[eq-ctor]
          { }
          {c_k ≃ c_k} \qquad
        \inferrule[eq-lam-pf]
          {∀i ∈ 1, …, m.\; (λx{:}τ.\,e)\;v_i ⟶^* v ∧ v ≃ χ_i}
          {λx{:}τ.\,e ≃ \many{v_i ⇒ χ_i}{i < m}} \\
      \mfun{apply}(x, σ, \many{v_i ⇒ χ_i}{i < m}) = [v_1/x]σ ↦ χ_1, …, [v_m/x]σ ↦ χ_m
    \end{gather*}
  \end{center}
  \hrule
  \caption{\lsyn{} synthesis and equivalence}
  \label{fig:lsyn-synthesis}
\end{figure}
